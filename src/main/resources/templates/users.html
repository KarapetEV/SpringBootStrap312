<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Admin Panel</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
          integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link th:rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark text-white">
    <div class="collapse navbar-collapse">
        <ul class="navbar-nav mr-auto">
            <a class="navbar-brand font-weight-bold" th:text="${user.getEmail()}"></a>
            <a class="navbar-brand "> with roles: </a>
            <a class="navbar-brand" th:text="${user.rolesToString()}"></a>
        </ul>
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link text-left" href="/logout">Logout</a>
            </li>
        </ul>
    </div>
</nav>

<main>
    <div class="main-div mt-5">
        <div class="row">
            <div class="col-md-2 mt-3 bg-white" style="padding-right: 10px; height: 100vh">
                <!--Навигация с вкладками слева (начало)-->
                <ul class="nav nav-pills flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#AllUsers">Admin</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#AllUsers">User</a>
                    </li>
                </ul>
                <!--Навигация с вкладками слева (конец)-->
            </div>
            <div class="col-md-10 mt-3 bg-light" style="height: 100vh">
                <div class="tab-content">
                    <!--Вкладка админа (начало)-->
                    <div class="tab-pane fade show active" id="AllUsers">
                        <h2>Admin panel</h2>
                        <ul class="nav nav-tabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#UsersTable">Users table</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#NewUser">New User</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="UsersTable">
                                <div class="card">
                                    <h5 class="card-header">All users</h5>
                                    <div class="card-body text-center">
                                        <!--Таблица юзеров (начало)-->
                                        <table class="table table-striped">
                                            <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>First Name</th>
                                                <th>Last Name</th>
                                                <th>Age</th>
                                                <th>Email</th>
                                                <th>Role</th>
                                                <th>Edit</th>
                                                <th>Delete</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <!--Данные юзеров-->
                                            <tr th:each="user : ${users}">
                                                <td th:text="${user.getId()}"></td>
                                                <td th:text="${user.getFirstName()}"></td>
                                                <td th:text="${user.getLastName()}"></td>
                                                <td th:text="${user.getAge()}"></td>
                                                <td th:text="${user.getEmail()}"></td>
                                                <td th:text="${user.rolesToString()}"></td>
                                                <!--Edit-->
                                                <td>
                                                    <a class="btn btn-info" role="button" data-toggle="modal"
                                                    data-target="#EditModal" th:attrappend="data-target=${user.getId()}">Edit</a>
                                                    <div class="modal fade" id="EditModal" th:attrappend="id=${user.id}"
                                                    tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title">Edit user</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body offset-sm-4 text-center">
                                                                    <form class="row g-3" th:method="PATCH"
                                                                          th:action="@{/admin/{id}(id=${user.getId()})}"
                                                                          th:object="${user}">
                                                                        <div class="row">
                                                                            <div class="form-group col-xs-12">
                                                                                <div class="control-group required">
                                                                                    <div class="controls">
                                                                                        <label for="id"
                                                                                            class="font-weight-bold">ID
                                                                                                <input type="text"
                                                                                                class="form-control"
                                                                                                id="id"
                                                                                                th:value="*{id}"
                                                                                                disabled>
                                                                                        </label>
                                                                                        <label th:for="firstName"
                                                                                                class="font-weight-bold">First Name
                                                                                            <input type="text"
                                                                                                    class="form-control"
                                                                                                    name="firstName"
                                                                                                    th:value="*{firstName}"
                                                                                                   required>
                                                                                        </label>
                                                                                        <label th:for="lastName"
                                                                                               class="font-weight-bold">Last Name
                                                                                            <input type="text"
                                                                                                   class="form-control"
                                                                                                   name="lastName"
                                                                                                   th:value="*{lastName}"
                                                                                                   required>
                                                                                        </label>
                                                                                        <label th:for="age"
                                                                                               class="font-weight-bold">Age
                                                                                            <input type="number"
                                                                                                   class="form-control"
                                                                                                   step="1"
                                                                                                   min="0"
                                                                                                   name="age"
                                                                                                   th:value="*{age}"
                                                                                                   required>
                                                                                        </label>
                                                                                        <label th:for="email"
                                                                                               class="font-weight-bold">Email
                                                                                            <input type="text"
                                                                                                   class="form-control"
                                                                                                   name="email"
                                                                                                   th:value="*{email}"
                                                                                                   required>
                                                                                        </label>
                                                                                        <label th:for="password"
                                                                                               class="font-weight-bold">Password
                                                                                            <input type="password"
                                                                                                   class="form-control"
                                                                                                   name="password"
                                                                                                   th:value="*{password}"
                                                                                                   required>
                                                                                        </label>
                                                                                        <label class="font-weight-bold">Role</label>
                                                                                        <div class="roles_combo">
                                                                                            <select class="form-control"
                                                                                                    name="roles"
                                                                                                    multiple size="2">
                                                                                                <div th:each="role : ${roles}">
                                                                                                    <option th:text="${role.getRole()}"
                                                                                                            th:value="${role.getRole()}"
                                                                                                            name="roles"></option>
                                                                                                </div>
                                                                                            </select>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="modal-body offset-sm-5">
                                                                            <button type="button"
                                                                                    class="btn btn-secondary"
                                                                                    data-dismiss="modal">Close</button>
                                                                            <button type="submit"
                                                                                    class="btn btn-primary">Edit</button>
                                                                        </div>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <!--Delete-->
                                                <td>
                                                    <a class="btn btn-danger" role="button" data-toggle="modal"
                                                       data-target="#modalDelete" th:attrappend="data-target=${user.getId()}">Delete</a>

                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <!--Таблица юзеров (конец)-->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--Вкладка админа (конец)-->
                </div>
            </div>
        </div>
    </div>
</main>

</body>
</html>